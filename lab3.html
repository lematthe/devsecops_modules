<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.11">
<title>Lab 3: OpenShift Role Based Access Control (RBAC)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_lab_3_openshift_role_based_access_control_rbac">Lab 3: OpenShift Role Based Access Control (RBAC)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_goal_of_lab_3">Goal of Lab 3</h3>
<div class="paragraph">
<p>The goal of this lab is to learn about the capabilities provided by OpenShift Role Based Access Control and how it can be used to access cluster based resources within an application.</p>
</div>
</div>
<div class="sect2">
<h3 id="_introduction">Introduction</h3>
<div class="paragraph">
<p>OpenShift, being a secure platform by default, has included support for authentication and authorization since the beginning of its Kubernetes lineage with version 3.0. Kubernetes originally did not have any form of Role Based Access Control and the work that was pioneered in OpenShift was eventually upstreamed and is now part of core capabilities of Kubernetes. As part of this lab, you will learn the differences between authentication and authorization including how they are implemented within OpenShift along with how they can be configured. Finally, you will use an application running within the platform to extend your knowledge of authentication and authorization to configure custom policies for the application to access cluster based resources.</p>
</div>
</div>
<div class="sect2">
<h3 id="_authentication_and_authorization_in_openshift">Authentication and Authorization in OpenShift</h3>
<div class="paragraph">
<p>Within the context of security, two of the fundamental terms are Authentication and Authorization. Let&#8217;s break down the differences and how they apply to OpenShift.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Authentication - Verifying the identity of a user</p>
</li>
<li>
<p>Authorization -  Verifying access to a resource</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_openshift_authentication">OpenShift Authentication</h3>
<div class="paragraph">
<p>A <em>User</em> is an entity that can make requests against the OpenShift API. They are broken out in the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Regular users - Typical individuals that access the cluster</p>
</li>
<li>
<p>System users - For use by infrastructure related assets, such as <em>nodes</em></p>
</li>
<li>
<p>Service Accounts - Special system users that are associated with Projects/Namespaces. These users are typically used to run pods or access the cluster within external systems.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Multiple users can then be organized into <strong>Groups</strong> to better manage policies within the cluster.</p>
</div>
<div class="paragraph">
<p>Authentication against the OpenShift API is accomplished using one of the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>OAuth Access Tokens - Asset for communicating with the OpenShift API once authenticated.</p>
</li>
<li>
<p>X.509 Client Certificates - Use of certificates to authenticate against the API</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_openshift_oauth_server_and_identity_providers">OpenShift OAuth Server and Identity Providers</h4>
<div class="paragraph">
<p>OpenShift contains an included OAuth server for allowing users to obtain access tokens for communicating with the API. The OAuth server can integrate with a number of identity providers that stores information about users. Common examples are <a href="https://docs.openshift.com/container-platform/4.7/authentication/identity_providers/configuring-ldap-identity-provider.html#configuring-ldap-identity-provider">LDAP</a>, <a href="https://docs.openshift.com/container-platform/4.7/authentication/identity_providers/configuring-htpasswd-identity-provider.html#configuring-htpasswd-identity-provider">HTPasswd</a> and <a href="https://docs.openshift.com/container-platform/4.7/authentication/identity_providers/configuring-oidc-identity-provider.html#configuring-oidc-identity-provider">OpenID Connect (OIDC)</a>.</p>
</div>
<div class="paragraph">
<p>A full discussion on OpenShift authentication can be found within the <a href="https://docs.openshift.com/container-platform/4.7/authentication/understanding-authentication.html">OpenShift Documentation</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_openshift_api">OpenShift API</h3>
<div class="paragraph">
<p>OpenShift emphasizes the use of declarative configurations and is the foundation for this schema. As a distributed system, all requests (whether they be from internal infrastructure resources or external components) invoke the API. The API is exposed as a series of RESTful endpoints and any request undergoes a series of steps prior to it being fulfilled completely. The following diagram depicts the steps of an API request:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/admission-controller-phases.png" alt="admission controller phases"></span></p>
</div>
<div class="sect3">
<h4 id="_openshift_role_based_access_control_rbac">OpenShift Role Based Access Control (RBAC)</h4>
<div class="paragraph">
<p>RBAC is used to determine whether a user is allowed to perform a given action. Authorization is managed using the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Rules - Sets of permitted verbs on a set of objects. For example, whether a user or service account can create pods</p>
</li>
<li>
<p>Roles - Collections of rules.</p>
</li>
<li>
<p>Bindings - Associations between users and/or groups with a role.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Roles and bindings can be created at one of the following scopes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Local - Scoped to a given project</p>
</li>
<li>
<p>Cluster - Applicable across all projects</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To simplify access within the platform, several default cluster roles are automatically configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>admin</code> - rights to view any resource in the project and modify any resource in the project except for quota.</p>
</li>
<li>
<p><code>basic-user</code> - A user that can get basic information about projects and users.</p>
</li>
<li>
<p><code>cluster-admin</code> - A super-user that can perform any action in any project. When bound to a user with a local binding, they have full control over quota and every action on every resource in the project.</p>
</li>
<li>
<p><code>cluster-status</code> - A user that can get basic cluster status information.</p>
</li>
<li>
<p><code>edit</code> - A user that can modify most objects in a project but does not have the power to view or modify roles or bindings.</p>
</li>
<li>
<p><code>self-provisioner</code> - A user that can create their own projects.</p>
</li>
<li>
<p><code>view</code> - A user who cannot make any modifications, but can see most objects in a project. They cannot view or modify roles or bindings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information on OpenShift RBAC can be found in the <a href="https://docs.openshift.com/container-platform/4.7/authentication/using-rbac.html">OpenShift Documentation</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lab_implementation">Lab Implementation</h3>
<div class="paragraph">
<p>To demonstrate many of the capabilities around managing Role Based Access Control in OpenShift, a sample application will be used to showcase not only how applications can be used to communicate with the OpenShift API, but also the levels of permissions that can be granted.</p>
</div>
<div class="sect3">
<h4 id="_prerequisites">Prerequisites</h4>
<div class="paragraph">
<p>Prior to starting the lab, the following should be available to you:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>OpenShift environment with cluster level permissions</p>
</li>
<li>
<p>OpenShift Command Line Interface (CLI)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_environment_walkthrough">Environment Walkthrough</h4>
<div class="paragraph">
<p>Login to OpenShift using the web console and from the <em>Administrator</em> perspective, on the lefthand navigation pane, expand <em>Home</em> and select <strong>Projects</strong>. If the <em>Developer</em> perspective is shown, select the <em>Developer</em> dropdown and select <em>Administrator</em>. Confirm that the <strong>rbac-lab</strong> project is displayed in the list of available projects.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/lab3-1-projects.png" alt="lab3 1 projects"></span></p>
</div>
<div class="paragraph">
<p>By expanding <em>Workloads</em> on the lefthand side, select <strong>Deployments</strong> and confirm <code>openshift-rbac</code> is displayed in the list of resources.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/lab3.2-deployments.png" alt="lab3.2 deployments"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If <code>openshift-rbac</code> is not present, confirm you are in the <code>rbac-lab</code> project by selecting <code>rbac-lab</code> from the <em>Project</em> dropdown at the top of the screen.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Feel free to browse the around to view the <em>Pods</em>, <em>Secrets</em>, and <em>ConfigMaps</em> that are part of the application.</p>
</div>
<div class="paragraph">
<p>Once complete, navigate to the <em>Route</em> that is exposed for the application. Expand the <em>Networking</em> pane on the lefthand navigation pane and select <strong>Routes</strong>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/lab3.1-routes.png" alt="lab3.1 routes"></span></p>
</div>
<div class="paragraph">
<p>Under the <em>Location</em> column, select the hyperlink to navigate to the application. Depending on the configuration of your environment, you may be presented with an insecure SSL warning as the application is communicating using secure transport. Accept the warning and continue navigating to the application. You should be presented with a screen similar to the following:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/lab3.1-applicationoverview.png" alt="lab3.1 applicationoverview"></span></p>
</div>
<div class="paragraph">
<p>The application is a simple golang based service that communicates with OpenShift to query various assets. The "<em>403 Forbidden</em>" error that is displayed is expected and we will work to resolve these conditions throughout the course of this exercise.</p>
</div>
</div>
<div class="sect3">
<h4 id="_api_access_for_applications">API Access For Applications</h4>
<div class="paragraph">
<p>Every pod that is deployed with OpenShift includes a set of tools that make it possible to communicate with the OpenShift API. These tools are found in the <code>/var/run/secrets/kubernetes.io/serviceaccount</code> directory.</p>
</div>
<div class="paragraph">
<p>Using the OpenShift CLI, ensure that you are logged into the cluster and change into the <code>rbac-lab</code> namespace.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc project rbac-lab</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once in the project, list the running pods by typing <strong>oc get pods</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc get pods</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>NAME                      READY   STATUS      RESTARTS   AGE
openshift-rbac-1-build    0/1     Completed   0          5h9m
openshift-rbac-1-deploy   0/1     Completed   0          5h7m
openshift-rbac-1-xgh4g    1/1     Running     0          5h7m</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, start a remote shell session in the running pod.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc rsh $(oc get pod -l=app=openshift-rbac -o jsonpath="{ .items[0].metadata.name }")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once a session has been established within the pod, list the contents of the <code>/var/run/secrets/kubernetes.io/serviceaccount</code> directory</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>ls -l /var/run/secrets/kubernetes.io/serviceaccount</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>total 0
lrwxrwxrwx. 1 root root 13 Apr 25 14:35 ca.crt -&gt; ..data/ca.crt
lrwxrwxrwx. 1 root root 16 Apr 25 14:35 namespace -&gt; ..data/namespace
lrwxrwxrwx. 1 root root 21 Apr 25 14:35 service-ca.crt -&gt; ..data/service-ca.crt
lrwxrwxrwx. 1 root root 12 Apr 25 14:35 token -&gt; ..data/token</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following contents are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ca.crt</code> - OpenShift Certificate Authority (CA)</p>
</li>
<li>
<p><code>namespace</code> - Contains the namespace the pod is currently running within</p>
</li>
<li>
<p><code>service-ca.crt</code> - OpenShift Service Certificate Authority</p>
</li>
<li>
<p><code>token</code> - Contains the OAuth token for the Service Account associated with the running pod</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The contents provided in this directory make it possible for applications to query the OpenShift API using the URL <a href="https://kubernetes.default.svc" class="bare">https://kubernetes.default.svc</a>. Try to query this endpoint using the curl command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>curl https://kubernetes.default.svc</code></pre>
</div>
</div>
<div class="paragraph">
<p>Executing the command will result in an error being displayed and indicates that the certificate for Kubernetes is not trusted. Fortunately, we have the CA for Kubernetes in our pod that we can specify. Execute the following command that refers to the CA file as described previously.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>curl --cacert /var/run/secrets/kubernetes.io/serviceaccount/ca.crt https://kubernetes.default.svc</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
  "kind": "Status",
  "apiVersion": "v1",
  "metadata": {

  },
  "status": "Failure",
  "message": "forbidden: User \"system:anonymous\" cannot get path \"/\"",
  "reason": "Forbidden",
  "details": {

  },
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Better. We are able to invoke the API, but we are receiving <em>Forbidden</em> error. Notice the message that is displayed. <code>User \"system:anonymous\" cannot get path \"</code>. Since we did not provide any credentials, OpenShift maps us into the reserved <code>system:anonymous</code> user. The OAuth token can be used to communicate with the API using the service account that is used to run the pod. Let&#8217;s make one more command that passes authentication as part of the request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>curl --cacert /var/run/secrets/kubernetes.io/serviceaccount/ca.crt -H "Authorization: Bearer $(cat /var/run/secrets/kubernetes.io/serviceaccount/token)" https://kubernetes.default.svc</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
  "paths": [
    "/api",
    "/api/v1",
    "/apis",
    "/apis/",
    "/apis/admissionregistration.k8s.io",
    "/apis/admissionregistration.k8s.io/v1",
    "/apis/admissionregistration.k8s.io/v1beta1",
    "/apis/apiextensions.k8s.io",
    "/apis/apiextensions.k8s.io/v1",
    "/apis/apiextensions.k8s.io/v1beta1",
    "/apis/apiregistration.k8s.io",
    "/apis/apiregistration.k8s.io/v1",
    "/apis/apiregistration.k8s.io/v1beta1",
    "/apis/apps",
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Great! We have successfully authenticated against the OpenShift api and see a list of endpoints that are exposed by the OpenShift API.</p>
</div>
<div class="paragraph">
<p>You can exit out of the running pod by typing <code>exit</code> and hit the <em>Return</em> key.</p>
</div>
</div>
<div class="sect3">
<h4 id="_roles_and_rolebindings">Roles and RoleBindings</h4>
<div class="paragraph">
<p>With a basic understanding of how applications can query information from the OpenShift API, let&#8217;s return our focus to the example application in the <code>rbac-lab</code> namespace. As you can see from the application viewed in the web browser, each of the requests against the API are returning a HTTP 403 error. This error indicates that authentication was successful, however, the user does not have the appropriate rights to access the requested service.</p>
</div>
<div class="paragraph">
<p>The first query attempts to list all <em>pods</em> that are found in the current namespace. Recall that permission scope in OpenShift can either be at a namespace or cluster level. Since listing <em>pods</em> in the current namespace is limited to only a single namespace, a <code>role</code> would be applicable for defining the policies that could be applied.</p>
</div>
<div class="paragraph">
<p>As covered in the overview section, any policy requires the following considerations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resources that would be queried</p>
</li>
<li>
<p>Verbs associated to the request</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With those considerations in mind, a new role can be created for the application to allow the application to <code>list</code> all <code>pods</code> in the <code>rbac-lab</code> namespace.</p>
</div>
<div class="paragraph">
<p>Execute the following command to create a new <code>Role</code> called <code>pod-lister</code> that grants access to <code>list</code> all <code>pods</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc create role pod-lister --verb=list --resource=pods</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>role.rbac.authorization.k8s.io/pod-lister created</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can view the contents of the <code>pod-lister</code> role by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc get role pod-lister -o yaml</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  creationTimestamp: "2020-04-26T16:00:19Z"
  name: pod-lister
  namespace: rbac-lab
  resourceVersion: "598640"
  selfLink: /apis/rbac.authorization.k8s.io/v1/namespaces/rbac-lab/roles/pod-lister
  uid: 8e3582b2-c8bb-469b-9a34-110735d4dbfd
rules:
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - list</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice how the resources and verbs are organized based on our desired intentions.</p>
</div>
<div class="paragraph">
<p>With the new role created, the next step is to associate the <code>pod-lister</code> role to the Service Account that is used to run the application. By default, all pods in OpenShift execute using the <code>default</code> Service Account. The association of namespace scoped roles to an entity, such as a Service Account, is accomplished using a <code>RoleBinding</code>.</p>
</div>
<div class="paragraph">
<p>Execute the following command to create a new <code>RoleBinding</code> called <code>pod-listers</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc create rolebinding pod-listers --role=pod-lister --serviceaccount=rbac-lab:default</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--serviceacount</code> flag takes the form <code>&lt;namespace&gt;:&lt;serviceaccount&gt;</code></p>
</div>
<div class="paragraph">
<p>View the contents of the <code>RoleBinding</code> by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc get rolebinding pod-listers -o yaml</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>kind: RoleBinding
metadata:
  creationTimestamp: "2020-04-26T16:08:25Z"
  name: pod-listers
  namespace: rbac-lab
  resourceVersion: "600800"
  selfLink: /apis/rbac.authorization.k8s.io/v1/namespaces/rbac-lab/rolebindings/pod-listers
  uid: 3691987a-5abb-4f84-a51e-a9984151aa8c
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: pod-lister
subjects:
- kind: ServiceAccount
  name: default
  namespace: rbac-lab</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the <code>Role</code> and <code>RoleBinding</code> now created in order for the <em>default</em> Service Account to list pods in the <code>rbac-lab</code> namespace, return to the application in the web browser and refresh the page to confirm that a valid response is now being displayed for the first query.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/lab3.2-pod-list-application.png" alt="lab3.2 pod list application"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_clusterroles_and_clusterrolebindings">ClusterRoles and ClusterRoleBindings</h4>
<div class="paragraph">
<p>With a basic understanding of <code>Roles</code> and <code>RoleBindings</code> as a way to grant access to resources in a single namespace, let&#8217;s attempt to resolve the authorization issue that still exists with the application. The next request attempts to list all <em>namespaces</em>. Listing all <em>namespaces</em> is a <em>cluster</em> scoped action and as a result, a <code>Role</code> cannot be used. Instead, a <code>ClusterRole</code> must be created in order to grant access to this resource.</p>
</div>
<div class="paragraph">
<p>Execute the following command to create a new <em>ClusterRole</em> called <code>namespace-lister</code> that grants access to <em>list</em> all <em>namespaces</em> in the cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc create clusterrole namespace-lister --verb=list --resource=namespace</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you receive an authorization error, be sure that you are logged into OpenShift using an account with elevated access.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, create a <code>ClusterRoleBinding</code> to associate the <code>pod-lister</code> <em>ClusterRole</em> to the <code>default</code> Service Account in the <code>rbac-lab</code> namespace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc create clusterrolebinding namespace-listers --clusterrole=namespace-lister --serviceaccount=rbac-lab:default</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the <em>ClusterRole</em> and <em>ClusterRoleBinding</em> created, return once again to the application in the web browser and refresh the page. The second query should now display a valid response.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/lab3.2-namespace-list-application.png" alt="lab3.2 namespace list application"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The number of namespaces may differ based on the contents of your OpenShift environment.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_api_groups">API Groups</h4>
<div class="paragraph">
<p>For the first few versions of Kubernetes, all of the API resources were located under a single endpoint (<code>v1</code>). To promote the emerging ecosystems of consumers looking to take advantage of the compute power of Kubernetes, the concept of <a href="https://kubernetes.io/docs/concepts/overview/kubernetes-api/#api-groups">API Groups</a> was created to provide a method to be able to manage their increasing number of API&#8217;s that would need to be registered. Instead of putting all of the desired endpoints under <code>v1</code>, the concept of API groups was created where developers could register their own API and have them be managed in a way similar to the core set of endpoints.</p>
</div>
<div class="paragraph">
<p><code>Namespaces</code> and <code>Pods</code> are part of the core API group. You may have noticed when creating the <code>Roles</code> and <code>ClusterRoles</code> the inclusion of the <code>apiGroups</code> field as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>...
rules:
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - list
  ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice how the <code>apiGroups</code> field is empty. This indicates that the desired resource is part of the core group. To view all of the API&#8217;s that are registered, the following command can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc api-resources</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>NAME                                  SHORTNAMES         APIVERSION                                    NAMESPACED   KIND
bindings                                                 v1                                            true         Binding
componentstatuses                     cs                 v1                                            false        ComponentStatus
configmaps                            cm                 v1                                            true         ConfigMap
endpoints                             ep                 v1                                            true         Endpoints
events                                ev                 v1                                            true         Event
mutatingwebhookconfigurations                            admissionregistration.k8s.io/v1               false        MutatingWebhookConfiguration
validatingwebhookconfigurations                          admissionregistration.k8s.io/v1               false        ValidatingWebhookConfiguration
customresourcedefinitions             crd,crds           apiextensions.k8s.io/v1                       false        CustomResourceDefinition
apiservices                                              apiregistration.k8s.io/v1                     false        APIService
apirequestcounts                                         apiserver.openshift.io/v1                     false        APIRequestCount
controllerrevisions                                      apps/v1                                       true         ControllerRevision
daemonsets                            ds                 apps/v1                                       true         DaemonSet
deployments                           deploy             apps/v1                                       true         Deployment
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>APIVERSION</em> column is a representation of both the version and the API group. Notice how the first few results only include the version <code>v1</code>. This indicates that they are part of the core group while <em>daemonsets</em> are part of the <em>apps</em> group. You can also add the <code>--namespaced</code> flag to limit resources that are either namespaced or cluster scoped.</p>
</div>
<div class="paragraph">
<p>For the final exercise, we will make use of a resource outside of the core API group to query all registered users.</p>
</div>
</div>
<div class="sect3">
<h4 id="_methods_of_verifying_api_access">Methods of Verifying API Access</h4>
<div class="paragraph">
<p>So far, we have used the application as an indicator for determining the level of access that the <em>default</em> Service Account has against the OpenShift API. However, there are other options available that can be used ahead of deployment time in order to validate the desired level of access. Through a concept called <a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/#user-impersonation"><em>User Impersonation</em></a>, requests can be made to appear as if it was originating from another user.</p>
</div>
<div class="paragraph">
<p>The <code>--as</code> flag can be used to specify the user to impersonate. When combined with the <code>oc auth can-i</code> command, it provides a method for determining whether a user can access an OpenShift API resource. Try this out by first determining whether your current user can list all users in the cluster by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc auth can-i list users</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Warning: resource 'users' is not namespace scoped in group 'user.openshift.io'
yes</code></pre>
</div>
</div>
<div class="paragraph">
<p>As indicated, since you are logged in with a user with elevated access to OpenShift, you can successfully list all users.</p>
</div>
<div class="paragraph">
<p>Now, use the User Impersonation capabilities to determine if the <em>default</em> Service Account in the <code>rbac-lab</code> namespace can list users.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc auth can-i list users --as=system:serviceaccount:rbac-lab:default</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Warning: resource 'users' is not namespace scoped in group 'user.openshift.io'
no</code></pre>
</div>
</div>
<div class="paragraph">
<p>As expected, the <em>default</em> Service Account does not have access. You may also notice that we needed to give the full name for the Service Account. In prior commands when creating <code>RoleBindings</code> and <code>ClusterRoleBindings</code>, we did not need to provide <code>system:serviceaccount</code> as it was assumed through the <code>--serviceaccount</code> flag.</p>
</div>
<div class="paragraph">
<p>In the final section, we wil create policies to enable the application to be able to query the number of users in OpenShift.</p>
</div>
</div>
<div class="sect3">
<h4 id="_creating_policies_for_resources_outside_the_core_api">Creating Policies for Resources Outside the Core API</h4>
<div class="paragraph">
<p>The process for creating policies for resources outside of the Core API is very similar to those within the Core API. As indicated previously, Users are cluster scoped and with that in mind, the ability to list all users in the cluster requires that a new <code>ClusterRole</code> and <code>ClusterRoleBinding</code> be created.</p>
</div>
<div class="paragraph">
<p>The first step is to determine the API group that users are part of. Use the <code>oc api-resources</code> command to help determine the API group</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc api-resources | grep users</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>users                                                  user.openshift.io/v1                     false        User</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first column indicates the resource while the second column indicates the API Group.</p>
</div>
<div class="paragraph">
<p>Now that we know the API Group users are part of, we can create a ClusterRole called <code>user-lister</code> using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc create clusterrole user-lister --verb=list --resource=users.user.openshift.io</code></pre>
</div>
</div>
<div class="paragraph">
<p>The combination of the resource name and the API Group is used in the <code>--resource</code> flag.</p>
</div>
<div class="paragraph">
<p>Finally, create a <code>ClusterRoleBinding</code> to grant access to the default Service Account to the newly created <code>ClusterRole</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc create clusterrolebinding user-listers --clusterrole=user-lister --serviceaccount=rbac-lab:default</code></pre>
</div>
</div>
<div class="paragraph">
<p>While we could confirm that the application can now query for users, let&#8217;s use User Impersonation to determine ahead of time whether the default Service Account has the appropriate rights.</p>
</div>
<div class="paragraph">
<p>Execute the following command to impersonate the default Service Account:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc auth can-i list users --as=system:serviceaccount:rbac-lab:default</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Warning: resource 'users' is not namespace scoped in group 'user.openshift.io'
yes</code></pre>
</div>
</div>
<div class="paragraph">
<p>With access verified, navigate to the application in the web browser and refresh the page to confirm all of the queries against the OpenShift API return valid results.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/lab3.3-users-list-application.png" alt="lab3.3 users list application"></span></p>
</div>
<div class="paragraph">
<p>By completing this lab, you should have a better understanding of the key components of OpenShift&#8217;s Role Based Access Control and how these capabilities provide for a more secure operating environment.</p>
</div>
<div class="paragraph">
<p><a href="#top">[top]</a></p>
</div>
<div class="paragraph">
<p><a href="README.adoc#table-of-contents"> Table of Contents </a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-09-16 14:01:52 -0400
</div>
</div>
</body>
</html>